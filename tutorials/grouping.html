

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  
    <title>Defining Sub-Groups in Your Data &#8212; FAT Forensics 0.0.1-dev1 documentation</title>
  <!-- html title is before nature.css - we use this hack to load bootstrap first -->
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="../_static/css/bootstrap.min.css">

    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_SVG"></script>
    <link rel="canonical" href="https://fat-forensics.org/tutorials/grouping.html" />
    <link rel="shortcut icon" href="../_static/fatf.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using Grouping to Evaluate Fairness of Data and Models – Group-Based Fairness" href="grouping-fairness.html" />
    <link rel="prev" title="Tutorials" href="index.html" />
  <!-- jQuery first, then Bootstrap JS -->
  <!-- jQuery is distributed with Sphinx already -->
  <!-- <script src="../_static/jquery.min.js"></script> -->
  <script src="../_static/js/bootstrap.min.js"></script>

  </head><body>
<div class="container">
  <nav class="navbar navbar-expand-md navbar-light bg-light">
    <a class="navbar-brand align-text-middle" href="../index.html">
      <img src="../_static/fatf.png"
       alt="Logo"
       width="35" height="35"
       class="d-inline-block align-middle">
      FAT-Forensics
    </a>

    <button class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-target="#navbarCollapsedContent">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse"
         id="navbarCollapsedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="../index.html">Home</a>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown">
            Documentation
          </a>
          <div class="dropdown-menu">
            <div class="dropdown-header">FAT-Forensics</div>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../getting_started/index.html">Getting Started</a>
            <a class="dropdown-item" href="index.html">Tutorials</a>
            <a class="dropdown-item" href="../sphinx_gallery_auto/index.html">Examples</a>
            <a class="dropdown-item" href="../api.html">API Reference</a>
            <a class="dropdown-item" href="../how_to/index.html">How-To Guides</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../news.html">News</a>
            <a class="dropdown-item" href="../development.html">Developers Guide</a>
            <a class="dropdown-item" href="../contributors.html">Contributors</a>
            <a class="dropdown-item" href="../changelog.html">Changelog</a>
            <a class="dropdown-item" href="../roadmap.html">Roadmap</a>
          </div>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown">
            FAT
          </a>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="../user_guide/index.html">FAT User Guide</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../user_guide/fairness/index.html"><b>F</b>airness</a>
            <a class="dropdown-item" href="../user_guide/accountability/index.html"><b>A</b>ccountability</a>
            <a class="dropdown-item" href="../user_guide/transparency/index.html"><b>T</b>ansparency</a>
          </div>
        </li>
      </ul>

      <div class="search_form form-inline">
          <div class="gcse-search" id="cse" style="width: 100%;"></div>
      </div>
    </div>
  </nav>
</div>

<!-- GitHub "fork me" ribbon -->
<!--
<a href="https://github.com/fat-forensics/fat-forensics">
  <img class="fork-me"
       style="position: absolute; top: 0; right: 0; border: 0;"
       src="../_static/img/forkme.png"
       alt="Fork me on GitHub" />
</a>
-->
<span id="forkongithub">
  <a href="https://github.com/fat-forensics/fat-forensics">
    Fork me on GitHub
  </a>
</span>
<div class="container">
  <div class="row">
    <div class="col-sm-2">
      <div class="container sidebar">
        <!--
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/fatf.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Exploring the Grouping Concept – Defining Sub-Populations</a><ul>
<li><a class="reference internal" href="#data-grouping">Data Grouping</a><ul>
<li><a class="reference internal" href="#grouping-based-on-a-numerical-feature">Grouping Based on a Numerical Feature</a></li>
<li><a class="reference internal" href="#grouping-based-on-a-numerical-feature-treat-as-a-categorical">Grouping Based on a Numerical Feature – Treat as a Categorical</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-grouping-to-inspect-a-data-set-data-transparency">Using Grouping to Inspect a Data Set – Data Transparency</a></li>
<li><a class="reference internal" href="#relevant-fat-forensics-examples">Relevant FAT Forensics Examples</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Tutorials</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="grouping-fairness.html"
                        title="next chapter">Using Grouping to Evaluate Fairness of Data and Models – Group-Based Fairness</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorials/grouping.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>-->
        <!-- Add a link to the 'up' page -->
        <div class="row rel">
          <div class="col rellink pad-b-1">
            <a class="btn btn-primary btn-sm"
               href="index.html"
               role="button">
              Up
              <br/>
              <span class="smallrellink">
                Tutorials
              </span>
              <span class="hiddenrellink left-button">
                Tutorials
              </span>
              
            </a>
          </div>
        </div>

        <!-- Add a links to the 'relative' pages -->

        <div class="row rel">
          <div class="col-6 rellink
                      pad-r-1
                      ">
            <a class="btn btn-primary btn-sm"
               href="index.html"
               accesskey="P"
               role="button">
              Previous
              <br/>
              <span class="smallrellink">
                Tutorials
              </span>
                  <span class="hiddenrellink
                               left-button
                               "
                        data-container="body">
                  Tutorials
                  </span>
            </a>
          </div>
          <div class="col-6 rellink
                      pad-l-1
                      ">
            <a class="btn btn-primary btn-sm"
               href="grouping-fairness.html"
               accesskey="N"
               role="button">
              Next
              <br/>
              <span class="smallrellink">
                Using Groupin...
              </span>
                  <span class="hiddenrellink
                               right-button
                               "
                        data-container="body">
                  Using Grouping to Evaluate Fairness of Data and Models – Group-Based Fairness
                  </span>
            </a>
          </div>
        </div>

        

        <!-- Add a citation banner -->
        <div class="alert alert-info" role="alert" style="font-size: 89%; margin-top: 16px;">
          Please <a href="../getting_started/cite.html"><b>cite us</b></a> if you use the software.
        </div>

        <!-- Add a page map -->

        <div class="row toc">
          <ul>
<li><a class="reference internal" href="#">Exploring the Grouping Concept – Defining Sub-Populations</a><ul>
<li><a class="reference internal" href="#data-grouping">Data Grouping</a><ul>
<li><a class="reference internal" href="#grouping-based-on-a-numerical-feature">Grouping Based on a Numerical Feature</a></li>
<li><a class="reference internal" href="#grouping-based-on-a-numerical-feature-treat-as-a-categorical">Grouping Based on a Numerical Feature – Treat as a Categorical</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-grouping-to-inspect-a-data-set-data-transparency">Using Grouping to Inspect a Data Set – Data Transparency</a></li>
<li><a class="reference internal" href="#relevant-fat-forensics-examples">Relevant FAT Forensics Examples</a></li>
</ul>
</li>
</ul>

        </div>

      </div>
    </div>
    

    <div class="col col-sm-10">
      <div class="container">
        <div class="row">
        
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="exploring-the-grouping-concept-defining-sub-populations">
<span id="tutorials-grouping"></span><h1>Exploring the Grouping Concept – Defining Sub-Populations<a class="headerlink" href="#exploring-the-grouping-concept-defining-sub-populations" title="Permalink to this headline">¶</a></h1>
<div class="topic">
<p class="topic-title first">Tutorial Contents</p>
<p>In this tutorial, we introduce the concept of sub-populations that is very
useful in a number of <a class="reference internal" href="../sphinx_gallery_auto/index.html#fairness-examples"><span class="std std-ref">Fairness</span></a> and
<a class="reference internal" href="../sphinx_gallery_auto/index.html#accountability-examples"><span class="std std-ref">Accountability</span></a>. The idea is to find
indices of data points (rows) or the data points themselves that form
separate subpopulations, which may be underrepresented in the training data
or disparately treated by a predictive model.</p>
</div>
<p>As always, we start by importing FAT Forensics inside a Python interpreter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python
&gt;&gt;&gt; import fatf
</pre></div>
</div>
<p>We also import numpy and pretty print (<code class="docutils literal notranslate"><span class="pre">pprint</span></code>) as we will need these for
the tutorial:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="k">import</span> <span class="n">pprint</span>
</pre></div>
</div>
<p>There are two different types of features that our data can be grouped on:</p>
<ul class="simple">
<li><p>categorical – usually string-based or numerical with a finite number of
possible values with groups being defined by <em>disjoint</em> sub-sets of that
feature space, or</p></li>
<li><p>numerical – integer- or floating point-based with the groups defined by
ranges on the feature space.</p></li>
</ul>
<div class="section" id="data-grouping">
<h2>Data Grouping<a class="headerlink" href="#data-grouping" title="Permalink to this headline">¶</a></h2>
<div class="section" id="grouping-based-on-a-numerical-feature">
<h3>Grouping Based on a Numerical Feature<a class="headerlink" href="#grouping-based-on-a-numerical-feature" title="Permalink to this headline">¶</a></h3>
<p>The very basic grouping that one may desire is based on the unique values of
the <em>target vector</em> for a classification task. Such grouping can be useful when
inspecting the distribution of certain features between different classes.</p>
<p>Before we continue, let us load the iris data set, which we will use for this
tutorial:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fatf.utils.data.datasets</span> <span class="k">as</span> <span class="nn">fatf_datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris_data_dict</span> <span class="o">=</span> <span class="n">fatf_datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris_data</span> <span class="o">=</span> <span class="n">iris_data_dict</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The <em>target array</em> can be accessed via the <code class="docutils literal notranslate"><span class="pre">'target'</span></code> key in the
<code class="docutils literal notranslate"><span class="pre">iris_data_dict</span></code> dictionary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iris_target</span> <span class="o">=</span> <span class="n">iris_data_dict</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">iris_target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(150,)</span>
</pre></div>
</div>
<p>Since the <code class="docutils literal notranslate"><span class="pre">iris_target</span></code> vector is 1-dimensional and the grouping function
(<a class="reference internal" href="../generated/fatf.utils.data.tools.group_by_column.html#fatf.utils.data.tools.group_by_column" title="fatf.utils.data.tools.group_by_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">fatf.utils.data.tools.group_by_column</span></code></a>) requires a data set, i.e. a
2-dimensional numpy array, we need to reshape it to <code class="docutils literal notranslate"><span class="pre">(150,</span> <span class="pre">1)</span></code> first:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iris_target_2d</span> <span class="o">=</span> <span class="n">iris_target</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">150</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris_target_2d</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(150, 1)</span>
</pre></div>
</div>
<p>Now, that we have the target array in the right shape, let us see what are all
the unique values that it holds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">iris_target_2d</span><span class="p">)</span>
<span class="go">array([0, 1, 2])</span>
</pre></div>
</div>
<p>Since the target array is a numerical array, when we use the
<a class="reference internal" href="../generated/fatf.utils.data.tools.group_by_column.html#fatf.utils.data.tools.group_by_column" title="fatf.utils.data.tools.group_by_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">fatf.utils.data.tools.group_by_column</span></code></a> function, it will infer that the
type of the column is <em>numerical</em> and treat it as such, which will lead to
binning the target vector rather than grouping it based on its unique values
(the second parameter in the function call below indicates that we want to
perform the grouping based on the 1st column, which index is <code class="docutils literal notranslate"><span class="pre">0</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fatf.utils.data.tools</span> <span class="k">as</span> <span class="nn">fatf_data_tools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num</span> <span class="o">=</span> <span class="n">fatf_data_tools</span><span class="o">.</span><span class="n">group_by_column</span><span class="p">(</span><span class="n">iris_target_2d</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../generated/fatf.utils.data.tools.group_by_column.html#fatf.utils.data.tools.group_by_column" title="fatf.utils.data.tools.group_by_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">group_by_column</span></code></a> function returns a 2-tuple with the first element
being the grouping (row indices) and the second being group names. Let us see
what groups we got:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[&#39;x &lt;= 0.4&#39;, &#39;0.4 &lt; x &lt;= 0.8&#39;, &#39;0.8 &lt; x &lt;= 1.2000000000000002&#39;, &#39;1.2000000000000002 &lt; x &lt;= 1.6&#39;, &#39;1.6 &lt; x&#39;]</span>
</pre></div>
</div>
<p>As expected, the grouping is numerical with 5 bind (the default). To get the
desired binning – three groups, one with 0s, one with 1s and the last one with
2s – we can either modify the bin boundaries or force the
<a class="reference internal" href="../generated/fatf.utils.data.tools.group_by_column.html#fatf.utils.data.tools.group_by_column" title="fatf.utils.data.tools.group_by_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">group_by_column</span></code></a> function to treat this numerical vector as a
categorical one. Let us start with the custom numerical binning:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_custom</span> <span class="o">=</span> <span class="n">fatf_data_tools</span><span class="o">.</span><span class="n">group_by_column</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">iris_target_2d</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">groupings</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_custom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[&#39;x &lt;= 0.5&#39;, &#39;0.5 &lt; x &lt;= 1.5&#39;, &#39;1.5 &lt; x&#39;]</span>
</pre></div>
</div>
<p>This binning should create 3 bins, each with 50 indices; the first one with
indices between 0 and 49, the second one with indices between 50 and 99 and the
last one with indices between 100 and 149 as this is how the labels are
distributed (they are ordered, to see this you can inspect the <code class="docutils literal notranslate"><span class="pre">iris_target</span></code>
variable):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">target_grouping_num_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149]</span>
</pre></div>
</div>
</div>
<div class="section" id="grouping-based-on-a-numerical-feature-treat-as-a-categorical">
<h3>Grouping Based on a Numerical Feature – Treat as a Categorical<a class="headerlink" href="#grouping-based-on-a-numerical-feature-treat-as-a-categorical" title="Permalink to this headline">¶</a></h3>
<p>Instead of this elaborate workaround we can simply setting the
<code class="docutils literal notranslate"><span class="pre">treat_as_categorical</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">True</span></code> and the numerical vector will
be treated as a categorical one, therefore grouping based on the unique
values in that vector:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_cat</span> <span class="o">=</span> <span class="n">fatf_data_tools</span><span class="o">.</span><span class="n">group_by_column</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">iris_target_2d</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">treat_as_categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_cat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[&#39;(0,)&#39;, &#39;(1,)&#39;, &#39;(2,)&#39;]</span>
</pre></div>
</div>
<p>Therefore, the first group has indices of the target value equal to 1, etc.
Now, let us see whether the grouping is the same as the one that we got in
<code class="docutils literal notranslate"><span class="pre">target_grouping_num_custom</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">target_grouping_num_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">target_grouping_num_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">target_grouping_num_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">target_grouping_num_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">target_grouping_num_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">target_grouping_num_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>You may wonder why the groups are defined as tuples with just one element, i.e.
<code class="docutils literal notranslate"><span class="pre">'(0,)'</span></code>. This is because the categorical groupings can be customised to
include multiple values in a single group. To see how that works, let us group
<code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> together with the other group including just <code class="docutils literal notranslate"><span class="pre">2</span></code>. To this
end, we use the <code class="docutils literal notranslate"><span class="pre">groupings</span></code> parameter again but this time in a manner
that is recognised by a categorical grouping:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_cat_custom</span> <span class="o">=</span> <span class="n">fatf_data_tools</span><span class="o">.</span><span class="n">group_by_column</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">iris_target_2d</span><span class="p">,</span>
<span class="gp">... </span>    <span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">treat_as_categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">groupings</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_grouping_num_cat_custom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[&#39;(0, 1)&#39;, &#39;(2,)&#39;]</span>
</pre></div>
</div>
<p>That looks promising, let us see whether the grouping is correct:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">target_grouping_num_cat_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
<span class="gp">... </span>               <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">target_grouping_num_cat_custom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
<span class="gp">... </span>               <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-grouping-to-inspect-a-data-set-data-transparency">
<span id="tutorials-grouping-data-transparency"></span><h2>Using Grouping to Inspect a Data Set – Data Transparency<a class="headerlink" href="#using-grouping-to-inspect-a-data-set-data-transparency" title="Permalink to this headline">¶</a></h2>
<p>Now that we know how to create groupings of data sets we can use this knowledge
to inspect transparency of the Iris data set. First, let us choose one of the
features – <code class="docutils literal notranslate"><span class="pre">'petal</span> <span class="pre">length</span> <span class="pre">(cm)'</span></code> with index <code class="docutils literal notranslate"><span class="pre">2</span></code> – and see how it is
distributed for the whole data set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arbitrary_feature_index</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arbitrary_feature_name</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="n">iris_data_dict</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">][</span><span class="n">arbitrary_feature_index</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arbitrary_feature_name</span>
<span class="go">&#39;petal length (cm)&#39;</span>
</pre></div>
</div>
<p>Let us see how this feature is distributed for the whole data set using the
<a class="reference internal" href="../generated/fatf.transparency.data.describe_functions.describe_array.html#fatf.transparency.data.describe_functions.describe_array" title="fatf.transparency.data.describe_functions.describe_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">fatf.transparency.data.describe_functions.describe_array</span></code></a> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fatf.transparency.data.describe_functions</span> <span class="k">as</span> <span class="nn">fatf_describe_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">petal_length_desc</span> <span class="o">=</span> <span class="n">fatf_describe_data</span><span class="o">.</span><span class="n">describe_array</span><span class="p">(</span><span class="n">iris_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">petal_length_desc</span><span class="p">)</span>
<span class="go">{&#39;25%&#39;: 1.600000023841858,</span>
<span class="go"> &#39;50%&#39;: 4.3500001430511475,</span>
<span class="go"> &#39;75%&#39;: 5.099999904632568,</span>
<span class="go"> &#39;count&#39;: 150,</span>
<span class="go"> &#39;max&#39;: 6.9,</span>
<span class="go"> &#39;mean&#39;: 3.7580001,</span>
<span class="go"> &#39;min&#39;: 1.0,</span>
<span class="go"> &#39;nan_count&#39;: 0,</span>
<span class="go"> &#39;std&#39;: 1.7594041}</span>
</pre></div>
</div>
<p>Therefore, we have 150 data points with values ranging between <code class="docutils literal notranslate"><span class="pre">1.0</span></code> and
<code class="docutils literal notranslate"><span class="pre">6.9</span></code>. The mean of this feature for the whole data set is <code class="docutils literal notranslate"><span class="pre">3.76</span></code> while the
median is <code class="docutils literal notranslate"><span class="pre">4.35</span></code>. Let us compare it against the distribution of this feature
for each of the three classes. To this end, we first need to split the Iris
data set using the grouping that we created in the previous section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">petal_length_class_0</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="n">target_grouping_num_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                                 <span class="n">arbitrary_feature_index</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">petal_length_class_1</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="n">target_grouping_num_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                                 <span class="n">arbitrary_feature_index</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">petal_length_class_2</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="n">target_grouping_num_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                                 <span class="n">arbitrary_feature_index</span><span class="p">]</span>
</pre></div>
</div>
<p>Now, we can create a description of the <code class="docutils literal notranslate"><span class="pre">'petal</span> <span class="pre">length</span> <span class="pre">(cm)'</span></code> feature for
each class separately:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">petal_length_class_0_desc</span> <span class="o">=</span> <span class="n">fatf_describe_data</span><span class="o">.</span><span class="n">describe_array</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">petal_length_class_0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">iris_data_dict</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">setosa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">petal_length_class_0_desc</span><span class="p">)</span>
<span class="go">{&#39;25%&#39;: 1.399999976158142,</span>
<span class="go"> &#39;50%&#39;: 1.5,</span>
<span class="go"> &#39;75%&#39;: 1.5750000178813934,</span>
<span class="go"> &#39;count&#39;: 50,</span>
<span class="go"> &#39;max&#39;: 1.9,</span>
<span class="go"> &#39;mean&#39;: 1.462,</span>
<span class="go"> &#39;min&#39;: 1.0,</span>
<span class="go"> &#39;nan_count&#39;: 0,</span>
<span class="go"> &#39;std&#39;: 0.1719186}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">petal_length_class_1_desc</span> <span class="o">=</span> <span class="n">fatf_describe_data</span><span class="o">.</span><span class="n">describe_array</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">petal_length_class_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">iris_data_dict</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="go">versicolor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">petal_length_class_1_desc</span><span class="p">)</span>
<span class="go">{&#39;25%&#39;: 4.0,</span>
<span class="go"> &#39;50%&#39;: 4.3500001430511475,</span>
<span class="go"> &#39;75%&#39;: 4.599999904632568,</span>
<span class="go"> &#39;count&#39;: 50,</span>
<span class="go"> &#39;max&#39;: 5.1,</span>
<span class="go"> &#39;mean&#39;: 4.26,</span>
<span class="go"> &#39;min&#39;: 3.0,</span>
<span class="go"> &#39;nan_count&#39;: 0,</span>
<span class="go"> &#39;std&#39;: 0.46518815}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">petal_length_class_2_desc</span> <span class="o">=</span> <span class="n">fatf_describe_data</span><span class="o">.</span><span class="n">describe_array</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">petal_length_class_2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">iris_data_dict</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="go">virginica</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">petal_length_class_2_desc</span><span class="p">)</span>
<span class="go">{&#39;25%&#39;: 5.099999904632568,</span>
<span class="go"> &#39;50%&#39;: 5.549999952316284,</span>
<span class="go"> &#39;75%&#39;: 5.8750001192092896,</span>
<span class="go"> &#39;count&#39;: 50,</span>
<span class="go"> &#39;max&#39;: 6.9,</span>
<span class="go"> &#39;mean&#39;: 5.552,</span>
<span class="go"> &#39;min&#39;: 4.5,</span>
<span class="go"> &#39;nan_count&#39;: 0,</span>
<span class="go"> &#39;std&#39;: 0.54634786}</span>
</pre></div>
</div>
<p>The results displayed above show that the <code class="docutils literal notranslate"><span class="pre">'petal</span> <span class="pre">length</span> <span class="pre">(cm)'</span></code> feature is a
good predictor of the iris plant type. The <em>setosa</em> type has petals of length
between 1 and 1.9 centimeters, whereas the petals of the <em>versicolor</em> type are
between 3 and 5.1 centimeters and the <em>virginica</em> type has petals in the range
of 4.5 and 6.9 centimeters. This tells us that petal length can help us to
distinguish between the <em>setosa</em> type and the other two types, however by just
using this feature we cannot tell apart the <em>versicolor</em> and <em>virginica</em> types.</p>
<hr class="docutils" />
<p>Getting all these insights was possible because of a data grouping based on the
target value (iris type). In addition to <strong>data transparency</strong> we can use
groupings to inspect <em>fairness</em> and <em>accountability</em> of data sets and
predictive models – group-based disparity metrics and data sampling issues/robustness of a predictive model respectively.</p>
<p>The next two tutorials show how to use grouping for <em>fairness</em>
(<a class="reference internal" href="grouping-fairness.html#tutorials-grouping-fairness"><span class="std std-ref">Using Grouping to Evaluate Fairness of Data and Models – Group-Based Fairness</span></a>) and <em>accountability</em>
(<a class="reference internal" href="grouping-robustness.html#tutorials-grouping-robustness"><span class="std std-ref">Using Grouping to Evaluate Robustness of Data and Models</span></a>) of data and models. To learn more about
transparency you can have a look at the <a class="reference internal" href="model-explainability.html#tutorials-model-explainability"><span class="std std-ref">Explaining a Machine Learning Model: ICE and PD</span></a>
or the <a class="reference internal" href="prediction-explainability.html#tutorials-prediction-explainability"><span class="std std-ref">Explaining Machine Learning Predictions: LIME and Counterfactuals</span></a> tutorial or code examples
referenced therein.</p>
</div>
<div class="section" id="relevant-fat-forensics-examples">
<h2>Relevant FAT Forensics Examples<a class="headerlink" href="#relevant-fat-forensics-examples" title="Permalink to this headline">¶</a></h2>
<p>The following examples provide more structured and code-focused use-cases of
the data grouping function and the data description functionality:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../sphinx_gallery_auto/transparency/xmpl_transparency_data_desc.html#sphx-glr-sphinx-gallery-auto-transparency-xmpl-transparency-data-desc-py"><span class="std std-ref">Using Data Description Explainer</span></a>,</p></li>
<li><p><a class="reference internal" href="../sphinx_gallery_auto/fairness/xmpl_fairness_models_measure.html#sphx-glr-sphinx-gallery-auto-fairness-xmpl-fairness-models-measure-py"><span class="std std-ref">Measuring Fairness of a Predictive Model – Disparate Impact</span></a>.</p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container cusotm-footer">
    <div class="row">
      <div class="col-3">
        &copy; 2018--2019, Kacper Sokol et al.
      </div>
      <div class="col-6">
        <a class="footer-img-link" href="contributors.html#funding">
          <img src="../_static/img/bristol.svg" title="Univeristy of Bristol" style="max-height: 30px">
          &nbsp;
          <img src="../_static/img/thales.svg" title="Thales" style="max-height: 20px">
        </a>
        <br>
        <a href="contributors.html#funding" style="top: 4px; position: relative;">
          More information on our contributors
        </a>
      </div>
      <div class="col-3">
        <a href="../_sources/tutorials/grouping.rst.txt" rel="nofollow">
          Show this page source
        </a>
      </div>
    </div>
  </div>

  
  <script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-142154492-1', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  
  <script>
    (function() {
      var cx = '014039732624725851926:mpducezglrq';
      var gcse = document.createElement('script');
      gcse.type = 'text/javascript';
      gcse.async = true;
      gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gcse, s);
    })();
  </script>
  
  </body>
</html>