

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  
    <title>fatf.transparency.models.feature_influence.individual_conditional_expectation &#8212; FAT Forensics 0.1.0 documentation</title>
  <!-- html title is before nature.css - we use this hack to load bootstrap first -->
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="../_static/css/bootstrap.min.css">

    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_SVG"></script>
    <link rel="canonical" href="https://fat-forensics.org/generated/fatf.transparency.models.feature_influence.individual_conditional_expectation.html" />
    <link rel="shortcut icon" href="../_static/fatf.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="fatf.transparency.models.feature_influence.merge_ice_arrays" href="fatf.transparency.models.feature_influence.merge_ice_arrays.html" />
    <link rel="prev" title="fatf.transparency.data.describe_functions.describe_categorical_array" href="fatf.transparency.data.describe_functions.describe_categorical_array.html" />
  <!-- jQuery first, then Bootstrap JS -->
  <!-- jQuery is distributed with Sphinx already -->
  <!-- <script src="../_static/jquery.min.js"></script> -->
  <script src="../_static/js/bootstrap.min.js"></script>

  </head><body>
<div class="container">
  <nav class="navbar navbar-expand-md navbar-light bg-light">
    <a class="navbar-brand align-text-middle" href="../index.html">
      <img src="../_static/fatf.png"
       alt="Logo"
       width="35" height="35"
       class="d-inline-block align-middle">
      FAT Forensics
    </a>

    <button class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-target="#navbarCollapsedContent">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse"
         id="navbarCollapsedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="../index.html">Home</a>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown">
            Documentation
          </a>
          <div class="dropdown-menu">
            <div class="dropdown-header">FAT Forensics</div>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../getting_started/index.html">Getting Started</a>
            <a class="dropdown-item" href="../tutorials/index.html">Tutorials</a>
            <a class="dropdown-item" href="../sphinx_gallery_auto/index.html">Examples</a>
            <a class="dropdown-item" href="../api.html">API Reference</a>
            <a class="dropdown-item" href="../how_to/index.html">How-To Guides</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../news.html">News</a>
            <a class="dropdown-item" href="../development.html">Developers Guide</a>
            <a class="dropdown-item" href="../contributors.html">Contributors</a>
            <a class="dropdown-item" href="../changelog.html">Changelog</a>
            <a class="dropdown-item" href="../roadmap.html">Roadmap</a>
          </div>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="../user_guide/index.html">
            FAT User Guide
          </a>
        </li>
      </ul>

      <div class="search_form form-inline">
          <div class="gcse-search" id="cse" style="width: 100%;"></div>
      </div>
    </div>
  </nav>
</div>

<!-- GitHub "fork me" ribbon -->
<!--
<a href="https://github.com/fat-forensics/fat-forensics">
  <img class="fork-me"
       style="position: absolute; top: 0; right: 0; border: 0;"
       src="../_static/img/forkme.png"
       alt="Fork me on GitHub" />
</a>
-->
<span id="forkongithub">
  <a href="https://github.com/fat-forensics/fat-forensics">
    Fork me on GitHub
  </a>
</span>
<div class="container">
  <div class="row">
    <div class="col-sm-2">
      <div class="container sidebar">
        <!--
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/fatf.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fatf.transparency.models.feature_influence</span></code>.individual_conditional_expectation</a><ul>
<li><a class="reference internal" href="#examples-using-fatf-transparency-models-feature-influence-individual-conditional-expectation">Examples using <code class="docutils literal notranslate"><span class="pre">fatf.transparency.models.feature_influence.individual_conditional_expectation</span></code></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fatf.transparency.data.describe_functions.describe_categorical_array.html"
                        title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fatf.transparency.data.describe_functions</span></code>.describe_categorical_array</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fatf.transparency.models.feature_influence.merge_ice_arrays.html"
                        title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fatf.transparency.models.feature_influence</span></code>.merge_ice_arrays</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/generated/fatf.transparency.models.feature_influence.individual_conditional_expectation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>-->
        <!-- Add a link to the 'up' page -->
        <div class="row rel">
          <div class="col rellink pad-b-1">
            <a class="btn btn-primary btn-sm"
               href="../api.html"
               role="button">
              Up
              <br/>
              <span class="smallrellink">
                API Reference (0.1.0)
              </span>
              <span class="hiddenrellink left-button">
                API Reference (0.1.0)
              </span>
              
            </a>
          </div>
        </div>

        <!-- Add a links to the 'relative' pages -->

        <div class="row rel">
          <div class="col-6 rellink
                      pad-r-1
                      ">
            <a class="btn btn-primary btn-sm"
               href="fatf.transparency.data.describe_functions.describe_categorical_array.html"
               accesskey="P"
               role="button">
              Previous
              <br/>
              <span class="smallrellink">
                fatf.transpar...
              </span>
                  <span class="hiddenrellink
                               left-button
                               "
                        data-container="body">
                  fatf.transparency.data.describe_functions.describe_categorical_array
                  </span>
            </a>
          </div>
          <div class="col-6 rellink
                      pad-l-1
                      ">
            <a class="btn btn-primary btn-sm"
               href="fatf.transparency.models.feature_influence.merge_ice_arrays.html"
               accesskey="N"
               role="button">
              Next
              <br/>
              <span class="smallrellink">
                fatf.transpar...
              </span>
                  <span class="hiddenrellink
                               right-button
                               "
                        data-container="body">
                  fatf.transparency.models.feature_influence.merge_ice_arrays
                  </span>
            </a>
          </div>
        </div>

        

        <!-- Add a citation banner -->
        <div class="alert alert-info" role="alert" style="font-size: 89%; margin-top: 16px;">
          Please <a href="../getting_started/cite.html"><b>cite us</b></a> if you use the software.
        </div>

        <!-- Add a page map -->

        <div class="row toc">
          <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fatf.transparency.models.feature_influence</span></code>.individual_conditional_expectation</a><ul>
<li><a class="reference internal" href="#examples-using-fatf-transparency-models-feature-influence-individual-conditional-expectation">Examples using <code class="docutils literal notranslate"><span class="pre">fatf.transparency.models.feature_influence.individual_conditional_expectation</span></code></a></li>
</ul>
</li>
</ul>

        </div>

      </div>
    </div>
    

    <div class="col col-sm-10">
      <div class="container">
        <div class="row">
        
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fatf-transparency-models-feature-influence-individual-conditional-expectation">
<h1><a class="reference internal" href="../api.html#module-fatf.transparency.models.feature_influence" title="fatf.transparency.models.feature_influence"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fatf.transparency.models.feature_influence</span></code></a>.individual_conditional_expectation<a class="headerlink" href="#fatf-transparency-models-feature-influence-individual-conditional-expectation" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="fatf.transparency.models.feature_influence.individual_conditional_expectation">
<code class="descclassname">fatf.transparency.models.feature_influence.</code><code class="descname">individual_conditional_expectation</code><span class="sig-paren">(</span><em>dataset: numpy.ndarray, model: object, feature_index: Union[int, str], treat_as_categorical: Optional[bool] = None, steps_number: Optional[int] = None, include_rows: Union[int, List[int], None] = None, exclude_rows: Union[int, List[int], None] = None</em><span class="sig-paren">)</span> &#x2192; Tuple[numpy.ndarray, numpy.ndarray]<a class="reference external" href="https://github.com/fat-forensics/fat-forensics/blob/0bb69b2/fatf/transparency/models/feature_influence.py#L269"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatf.transparency.models.feature_influence.individual_conditional_expectation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates Individual Conditional Expectation for a selected feature.</p>
<p>Based on the provided dataset and model this function computes Individual
Conditional Expectation (ICE) of a selected feature for all target classes.
If <code class="docutils literal notranslate"><span class="pre">treat_as_categorical</span></code> parameter is not provided the function will
infer the type of the selected feature and compute the appropriate ICE.
Otherwise, the user can specify whether the selected feature should be
treated as a categorical or numerical feature. If the selected feature is
numerical, you can specify the number of samples between this feature’s
minimum and maximum value for which the input model will be evaluated.
By default this value is set to 100.</p>
<p>Finally, it is possible to filter the rows of the input dataset that will
be used to calculate ICE with <code class="docutils literal notranslate"><span class="pre">include_rows</span></code> and <code class="docutils literal notranslate"><span class="pre">exclude_rows</span></code>
parameters. If <code class="docutils literal notranslate"><span class="pre">include_rows</span></code> is specified ICE will only be calculated
for these rows. If both include and exclude parameters are given, ICE will
be computed for the set difference. Finally, if only the exclude parameter
is specified, these rows will be subtracted from the whole dataset.</p>
<p>This approach is an implementation of a method introduced by
<a class="reference internal" href="#rb8c01d2ff2d3-goldstein2015peeking" id="id1">[GOLDSTEIN2015PEEKING]</a>. It is intended to be used with probabilistic
models, therefore the input model must have a <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method.</p>
<dl class="citation">
<dt class="label" id="rb8c01d2ff2d3-goldstein2015peeking"><span class="brackets"><a class="fn-backref" href="#id1">GOLDSTEIN2015PEEKING</a></span></dt>
<dd><p>Goldstein, A., Kapelner, A., Bleich, J. and
Pitkin, E., 2015. Peeking inside the black box: Visualizing statistical
learning with plots of individual conditional expectation. Journal of
Computational and Graphical Statistics, 24(1), pp.44-65.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dataset</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>A dataset based on which ICE will be computed.</p>
</dd>
<dt><strong>model</strong><span class="classifier">object</span></dt><dd><p>A fitted model which predictions will be used to calculate ICE. (Please
see <a class="reference internal" href="fatf.utils.models.models.Model.html#fatf.utils.models.models.Model" title="fatf.utils.models.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">fatf.utils.models.models.Model</span></code></a> class documentation for the
expected model object specification.)</p>
</dd>
<dt><strong>feature_index</strong><span class="classifier">Union[integer, string]</span></dt><dd><p>An index of the feature column in the input dataset for which ICE will
be computed.</p>
</dd>
<dt><strong>treat_as_categorical</strong><span class="classifier">boolean, optional (default=None)</span></dt><dd><p>Whether to treat the selected feature as categorical or numerical.</p>
</dd>
<dt><strong>steps_number</strong><span class="classifier">integer, optional (default=None, i.e. 100)</span></dt><dd><p>The number of evenly spaced samples between the minimum and the maximum
value of the selected feature for which the model’s prediction will be
evaluated. (This parameter applies only to numerical features.)</p>
</dd>
<dt><strong>include_rows</strong><span class="classifier">Union[int, List[int]], optional (default=None)</span></dt><dd><p>Indices of rows that will be included in the ICE calculation. If this
parameter is specified, ICE will only be calculated for the selected
rows. If additionally <code class="docutils literal notranslate"><span class="pre">exclude_rows</span></code> is specified the selected rows
will be a set difference between the two. This parameter can either be
a <em>list</em> of indices or a single index (integer).</p>
</dd>
<dt><strong>exclude_rows</strong><span class="classifier">Union[int, List[int]], optional (default=None)</span></dt><dd><p>The indices of rows to be excluded from the ICE calculation. If this
parameter is specified and <code class="docutils literal notranslate"><span class="pre">include_rows</span></code> is not, these indices will
be excluded from all of the rows. If both include and exclude
parameters are specified, the rows included in the ICE calculation will
be a set difference of the two. This parameter can either be a <em>list</em>
of indices or a single index (integer).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ice</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>An array of Individual Conditional Expectations for all of the selected
dataset rows and the feature (dataset column) of choice. It’s of the
(n_samples, steps_number, n_classes) shape where n_samples is the
number of rows selected from the dataset for the ICE computation,
steps_number is the number of generated samples for the selected
feature and n_classes is the number of classes in the target of the
dataset. The numbers in this array represent the probability of every
class for every selected data point when the selected feature is fixed
to one of the values in the generated feature linespace (see below).</p>
</dd>
<dt><strong>feature_linespace</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>A one-dimensional array – (steps_number, ) – with the values for
which the selected feature was substituted when the dataset was
evaluated with the specified model.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>IncompatibleModelError</strong></dt><dd><p>The model does not have required functionality – it needs to be able
to output probabilities via <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method.</p>
</dd>
<dt><strong>IncorrectShapeError</strong></dt><dd><p>The input dataset is not a 2-dimensional numpy array.</p>
</dd>
<dt><strong>IndexError</strong></dt><dd><p>Provided feature (column) index is invalid for the input dataset.</p>
</dd>
<dt><strong>TypeError</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">treat_as_categorical</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code> or boolean. The
<code class="docutils literal notranslate"><span class="pre">steps_number</span></code> parameter is not <code class="docutils literal notranslate"><span class="pre">None</span></code> or integer. Either
<code class="docutils literal notranslate"><span class="pre">include_rows</span></code> or <code class="docutils literal notranslate"><span class="pre">exclude_rows</span></code> parameter is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, an
integer or a list of integers.</p>
</dd>
<dt><strong>ValueError</strong></dt><dd><p>The input dataset must only contain base types (textual and numerical
values). One of the <code class="docutils literal notranslate"><span class="pre">include_rows</span></code> or <code class="docutils literal notranslate"><span class="pre">exclude_rows</span></code> indices is not
valid for the input dataset. The <code class="docutils literal notranslate"><span class="pre">steps_number</span></code> is smaller than 2.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Warns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>UserWarning</strong></dt><dd><p>The feature is treated as categorical but the number of steps parameter
is provided (not <code class="docutils literal notranslate"><span class="pre">None</span></code>). In this case the <code class="docutils literal notranslate"><span class="pre">steps_number</span></code> parameter
is ignored. Also, the user is warned when the selected feature is
detected to be categorical (textual) while the user indicated that it
is numerical.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<div class="section" id="examples-using-fatf-transparency-models-feature-influence-individual-conditional-expectation">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">fatf.transparency.models.feature_influence.individual_conditional_expectation</span></code><a class="headerlink" href="#examples-using-fatf-transparency-models-feature-influence-individual-conditional-expectation" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="This example illustrates how to use the Partial Dependence (PD) explainer and its plotting func..."><div class="figure align-center" id="id2">
<img alt="../_images/sphx_glr_xmpl_transparency_pd_thumb.png" src="../_images/sphx_glr_xmpl_transparency_pd_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../sphinx_gallery_auto/transparency/xmpl_transparency_pd.html#sphx-glr-sphinx-gallery-auto-transparency-xmpl-transparency-pd-py"><span class="std std-ref">Using Partial Dependence Explainer</span></a></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example illustrates how to use the Individual Conditional Expectation explainer and its pl..."><div class="figure align-center" id="id3">
<img alt="../_images/sphx_glr_xmpl_transparency_ice_thumb.png" src="../_images/sphx_glr_xmpl_transparency_ice_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../sphinx_gallery_auto/transparency/xmpl_transparency_ice.html#sphx-glr-sphinx-gallery-auto-transparency-xmpl-transparency-ice-py"><span class="std std-ref">Using Individual Conditional Expectation Explainer</span></a></span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
</div><div class="clear:both"></div></div>
</div>


          </div>
        </div>
      </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container cusotm-footer">
    <div class="row">
      <div class="col-3">
        &copy; 2018--2020, Kacper Sokol et al.
      </div>
      <div class="col-6">
        <a class="footer-img-link" href="contributors.html#funding">
          <img src="../_static/img/bristol.svg" title="Univeristy of Bristol" style="max-height: 30px">
          &nbsp;
          <img src="../_static/img/thales.svg" title="Thales" style="max-height: 20px">
        </a>
        <br>
        <a href="contributors.html#funding" style="top: 4px; position: relative;">
          More information on our contributors
        </a>
      </div>
      <div class="col-3">
        <a href="../_sources/generated/fatf.transparency.models.feature_influence.individual_conditional_expectation.rst.txt" rel="nofollow">
          Show this page source
        </a>
      </div>
    </div>
  </div>

  
  <script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-142154492-1', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  
  <script>
    (function() {
      var cx = '014039732624725851926:mpducezglrq';
      var gcse = document.createElement('script');
      gcse.type = 'text/javascript';
      gcse.async = true;
      gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gcse, s);
    })();
  </script>
  
  </body>
</html>